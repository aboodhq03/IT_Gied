@model List<IT_Gied.Models.CourseNodeVM>

@{
    ViewData["Title"] = "Courses Roadmap";
}

<link rel="stylesheet" href="~/css/courses-roadmap.css" asp-append-version="true" />

<div class="tree-legend" dir="rtl" lang="ar">
  <span class="legend-item">
    <span class="legend-line legend-line--dashed" aria-hidden="true"></span>
    <span class="legend-label">متزامنة</span>
  </span>

  <span class="legend-item">
    <span class="legend-line legend-line--solid" aria-hidden="true"></span>
    <span class="legend-label">سابق دراسة</span>
  </span>

  <span class="legend-item">
    <span class="legend-dot legend-dot--gray" aria-hidden="true"></span>
    <span class="legend-label">مغلقة</span>
  </span>

  <span class="legend-item">
    <span class="legend-dot legend-dot--blue" aria-hidden="true"></span>
    <span class="legend-label">متاحة</span>
  </span>

  <span class="legend-item">
    <span class="legend-dot legend-dot--green" aria-hidden="true"></span>
    <span class="legend-label">منجزة</span>
  </span>
</div>


<div class="roadmap-wrap">
    <div id="nodes" class="nodes">
        <svg id="edges" class="edges"></svg>

        @foreach (var c in Model)
        {
            var stateClass = c.IsCompleted ? "completed" : (c.IsUnlocked ? "unlocked" : "locked");
            var unlocksCsv = string.Join(",", c.Unlocks);

            <div class="node @stateClass"
                 data-id="@c.Id"
                 data-unlocks="@unlocksCsv">

                <div class="code">@c.Code</div>

                <div class="name" title="@c.Name">@c.Name</div>

               @*  @if (!string.IsNullOrWhiteSpace(c.Description))
                {
                    <div class="desc" title="@c.Description">@c.Description</div>
                } *@

                <form asp-controller="Courses" asp-action="ToggleComplete" method="post" class="done-form">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="courseId" value="@c.Id" />

                    <button class="btn-done" type="submit" @(c.IsUnlocked ? "" : "disabled")>
                        @(c.IsCompleted ? "إلغاء" : "إنجاز")
                    </button>
                
                    
                </form>
              <a class="btn btn-secondary btn-sm" asp-controller="Courses" asp-action="Details" asp-route-id="@c.Id">
    details
</a>
</div>
        }
    </div>
</div>

<script src="~/js/courses-roadmap.js" asp-append-version="true"></script>
