@model IEnumerable<IT_Gied.Models.NewsCardVM>

<style>
    /* container spacing */
    .news-wrap { margin-top: 12px; }

    /* make cards closer (works with Bootstrap row) */
    .news-grid { --bs-gutter-x: .65rem; --bs-gutter-y: .65rem; }

    .news-card {
        border: 0;
        border-radius: 14px;
        overflow: hidden;
        box-shadow: 0 10px 22px rgba(0,0,0,.08);
        background: #fff;
        transition: transform .15s ease, box-shadow .15s ease;
        height: 100%;
    }

    .news-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 14px 28px rgba(0,0,0,.12);
    }

    /* smaller image height so cards feel tighter */
    .news-thumb {
        height: 140px;
        width: 100%;
        object-fit: cover;
        background: #eef2f5;
        display: block;
    }

    /* fallback reduced + cleaner */
    .news-fallback {
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, rgba(22,163,74,.12), rgba(59,130,246,.10));
        color: #0f5132;
        font-weight: 700;
        letter-spacing: .2px;
        text-transform: none; /* was uppercase (took visual space) */
        font-size: .9rem;
        padding: 0 12px;
        text-align: center;
    }

    /* tighter text */
    .news-title {
        font-size: .98rem;
        font-weight: 700;
        line-height: 1.25;
        margin: 0 0 6px 0;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .news-title-link {
        color: #111;
        text-decoration: none;
    }

    .news-title-link:hover { text-decoration: underline; }

    .news-summary {
        color: #6c757d;
        font-size: .9rem;
        margin: 0;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        min-height: 3.2em; /* smaller than before */
    }

    .news-badges .badge { font-weight: 600; }

    /* reduce inner padding (Bootstrap p-3 is big) */
    .news-body { padding: .85rem .9rem; }

    /* meta row spacing */
    .news-meta { margin-bottom: .45rem; }

    /* optional: tighter "Read" button alignment if you have it */
    .news-actions {
        padding: .65rem .9rem .85rem .9rem;
        display: flex;
        justify-content: flex-end;
    }
</style>

<section class="container news-wrap">
    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-light border">
            No news loaded right now. Please try again later.
        </div>
    }
    else
    {
        <div class="row g-3">
            @foreach (var n in Model.Take(9))
            {
                var cat = (n.Category ?? "").Trim();
                var isOffer = cat.Equals("Offers", StringComparison.OrdinalIgnoreCase) || cat.Equals("Offer", StringComparison.OrdinalIgnoreCase);
                var isNew = cat.Equals("New Courses", StringComparison.OrdinalIgnoreCase) || cat.Equals("New", StringComparison.OrdinalIgnoreCase);

                <div class="col-12 col-md-6 col-lg-4">
                    <div class="news-card">

                        @* Image *@
                        @if (!string.IsNullOrWhiteSpace(n.ImageUrl))
                        {
                            <img class="news-thumb" src="@n.ImageUrl" alt="news image"
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                            <div class="news-fallback" style="display:none;">@n.Source</div>
                        }
                        else
                        {
                            <div class="news-fallback">@n.Source</div>
                        }

                        <div class="p-3">
                            <div class="d-flex justify-content-between align-items-center mb-2 news-badges">
                                <div class="d-flex gap-2 flex-wrap">
                                    <span class="badge bg-success">@n.Source</span>

                                    @* Category badge with special styling *@
                                    @if (isOffer)
                                    {
                                        <span class="badge bg-danger">Offer</span>
                                    }
                                    else if (isNew)
                                    {
                                        <span class="badge bg-primary">New</span>
                                    }
                                    else if (cat.Contains("AI", StringComparison.OrdinalIgnoreCase))
                                    {
                                        <span class="badge bg-dark">AI</span>
                                    }
                                    else if (cat.Contains("Data", StringComparison.OrdinalIgnoreCase))
                                    {
                                        <span class="badge bg-info text-dark">Data</span>
                                    }
                                    else if (!string.IsNullOrWhiteSpace(cat))
                                    {
                                        <span class="badge bg-secondary">@cat</span>
                                    }
                                </div>

                                @if (n.Published != null)
                                {
                                    <span class="text-muted small">
                                        @n.Published.Value.LocalDateTime.ToString("dd MMM yyyy")
                                    </span>
                                }
                            </div>

                            <h6 class="news-title">
                                <a class="news-title-link" href="@n.Url" target="_blank" rel="noopener">
                                    @n.Title
                                </a>
                            </h6>

                            @if (!string.IsNullOrWhiteSpace(n.Summary))
                            {
                                <p class="news-summary">@n.Summary</p>
                            }
                            else
                            {
                                <p class="news-summary">Open to read more details.</p>
                            }

                            <div class="mt-3 d-flex justify-content-end">
                                <a class="btn btn-outline-success btn-sm" href="@n.Url" target="_blank" rel="noopener">
                                    Read
                                </a>
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>
    }
</section>
